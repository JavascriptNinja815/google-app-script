<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <style>
      body {
        background: #d9d9d9;
      }
      .new_starts {
        border-style: ridge;
        height: 585px;
        width: 970px;
        overflow-y: scroll;
        display: flex;
        flex-wrap: wrap;
        margin: 1% 10%;
        background: white;
      }
      .flex-container {
        display: flex;
        flex-direction: column;
        margin: 9px;
        text-align: left;
      }
      img {
        width: 215px;
        height: 150px;
        margin-bottom: 20px;
      }
      table th {
        border: 1px solid black;
        color: black;
        padding: 3px;
      }
      table {
        width: 100%;
      }
      th {
        width: 14.3%;
        text-align: center;
      }
      td {
        border: none;
        color: black;
        padding: 3px;
        height: 25px;
      }
      h1 {
        color: white;
        margin-bottom: 0px;
      }
      .button-group {
        width: 1020px;
        text-align: right;
      }
      button {
        background: #0095ff;
        border-color: #07c;
        width: 90px;
        height: 30px;
        color: white;
        border-radius: 3px;
        font-weight: bold;
        cursor: pointer;
        margin-top: 10px;
      }
      button:hover {
        background: #07c;
      }
      .window {
        border-style: ridge;
        height: 585px;
        width: 970px;
        overflow-y: scroll;
        margin: 1% 10%;
        background: white;
      }
      .modal-dialog {
        width: 800px;
      }
      .first_table {
        border-collapse: collapse;
        width: 100%;
      }
      .second_table {
        border-collapse: collapse;
        width: 100%;
        margin-top: 8%;
      }
    </style>
  </head>
  <body><?
    var dataForNewStarts = getEmployeesByDate();
    var dataForCurrent = getEmployeesByName();
    var firstSchedule = getFirstSchedule();
    var secondSchedule = getSecondSchedule();
    var crew = detectCrew(new Date());
    var nextToday = new Date();
    nextToday.setDate(nextToday.getDate() + 7);
    var nextCrew = detectCrew(nextToday);
    if (crew == "A_C") {
      var a_c = [0, 1, 4, 5, 6];
      var b_d = [2, 3];
    } else if (crew == "B_D") {
      var a_c = [2, 3];
      var b_d = [0, 1, 4, 5, 6];
    }
    if (nextCrew == "A_C") {
      var next_a_c = [0, 1, 4, 5, 6];
      var next_b_d = [2, 3];
    } else if (nextCrew == "B_D") {
      var next_a_c = [2, 3];
      var next_b_d = [0, 1, 4, 5, 6];
    } ?>
    <div align="center">
      <h1>New Start Roster</h1><?
      var first = new Date();
      first.setHours(0,0,0,0);
      var last = new Date(first.getTime() + 8 * 24 * 60 * 60 * 1000); ?>
      <h2>For&nbsp; <?= Utilities.formatDate(first, "CST", "EEEE, MMM dd")?> - <?= Utilities.formatDate(last, "CST", "EEEE, MMM dd")?></h2>
      <div class="new_starts"><?
        for (var i = 0; i < dataForNewStarts.length; i++) {
          var start = new Date(new Date(dataForNewStarts[i][6]).getTime() + 2 * 60 * 60 * 1000);
          if (start >= first && start < last) {?>
          <div class="flex-container">
            <img src="<?= dataForNewStarts[i][8].replace("open", "uc");?>" >
            <label style="font-weight: bold;"> Start Date : <?= Utilities.formatDate(dataForNewStarts[i][6], "CST", "EEEE, MMM dd") ?></label>
            <label> Name: <?= dataForNewStarts[i][1] + ' ' + dataForNewStarts[i][2] ?></label>
            <label> Shift: <?= dataForNewStarts[i][4] ?></label>
            <label> Dept: <?= dataForNewStarts[i][3] ?></label>
          </div><?
          }
        }?>
      </div>
    </div>
    <div align="center">
      <h1>Current Roster - Roll Fed</h1>
      <div class="button-group">
        <button data-toggle="modal" data-target="#rollFedNextWeek">Next Week</button>
        <button onclick="htmlToPDF('roll_fed')">Print</button>
      </div>
      <div class="window" id="roll_fed">
        <div style="display: flex; flex-direction: column; width: 100%;" align="center">
          <label style="background: orange; font-size: 25px;">Roll Fed</label>
          <label style="font-size: 25px;">Week of: <?= Utilities.formatDate(getMonday('current'), "CST", "MM/dd/YY") ?></label>
        </div>
        <table class="first_table">
          <tr>
            <th>Monday</th>
            <th>Tuesday</th>
            <th>Wednesday</th>
            <th>Thursday</th> 
            <th>Friday</th>
            <th>Saturday</th>
            <th>Sunday</th>
          </tr>
          <tr><? var week = getWeek(1);
            for (var i in week) { ?>
              <th><?= Utilities.formatDate(week[i], "CST", "MM/dd/YY") ?></th><?
            } ?>
          </tr>
          <tr style="background: lightgray;"><?
            if (crew == "A_C") { ?>
              <th>A crew</th>
              <th>A crew</th>
              <th>B crew</th>
              <th>B crew</th>
              <th>A crew</th>
              <th>A crew</th>
              <th>A crew</th> <?
            } if (crew == "B_D") { ?>
              <th>B crew</th>
              <th>B crew</th>
              <th>A crew</th>
              <th>A crew</th>
              <th>B crew</th>
              <th>B crew</th>
              <th>B crew</th><?
            } ?>
          </tr>
        </table>
        <table class="second_table">
          <tr style="background: lightgray;"><?
            if (nextCrew == "A_C") { ?>
              <th>C crew</th>
              <th>C crew</th>
              <th>D crew</th>
              <th>D crew</th>
              <th>C crew</th>
              <th>C crew</th>
              <th>C crew</th><?
            } else { ?>
              <th>D crew</th>
              <th>D crew</th>
              <th>C crew</th>
              <th>C crew</th>
              <th>D crew</th>
              <th>D crew</th>
              <th>D crew</th><?
            } ?>
          </tr>
        </table>
      </div>
    </div>

  </body>
</html>
